import requests
from typing import Optional

class CVEAutoExploit:
    def __init__(self):
        self.nvd_api = "https://services.nvd.nist.gov/rest/json/cves/2.0"

    def get_exploitability(self, cve_id: str) -> Optional[dict]:
        """Check CVSS score and known exploits for a CVE"""
        try:
            response = requests.get(f"{self.nvd_api}?cveId={cve_id}")
            return {
                "score": response.json()["vulnerabilities"][0]["cvssMetricV2"]["cvssData"]["baseScore"],
                "exploited": "Exploit" in response.text
            }
        except:
            return None
